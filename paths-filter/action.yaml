name: 'Paths Filter'
description: ''

inputs:
  AWS_DEV_ACCOUNT:
    description: ''
    required: true
  AWS_STA_ACCOUNT:
    description: ''
    required: true
  AWS_PRO_ACCOUNT:
    description: ''
    required: true

outputs:
  AWS_ACCOUNT: 
    value: ${{ steps.filter_output.outputs.AWS_ACCOUNT }}
    description: ""
  ENV_FOLDER: 
    value: ${{ steps.filter_output.outputs.ENV_FOLDER }}
    description: ""

runs:
  using: "composite"

  steps:
  - uses: dorny/paths-filter@v3
    id: paths_filter
    with:
      filters: |
        dev:
          - 'dev/**'
        sta:
          - 'sta/**'
        pro:
          - 'pro/**'

  - name: Filter Output
    id: filter_output
    run: |
      if [ ${{ steps.paths_filter.outputs.dev }} == 'true' ]; then
        echo "AWS_ACCOUNT=$AWS_DEV_ACCOUNT" >> $GITHUB_OUTPUT
        echo "ENV_FOLDER=dev >> $GITHUB_OUTPUT
      elif [ ${{ steps.paths_filter.outputs.dev }} == 'true' ]; then
        echo "AWS_ACCOUNT=$AWS_STA_ACCOUNT" >> $GITHUB_OUTPUT
        echo "ENV_FOLDER=sta >> $GITHUB_OUTPUT
      elif [ ${{ steps.paths_filter.outputs.dev }} == 'true' ]; then
        echo "AWS_ACCOUNT=$AWS_PRO_ACCOUNT" >> $GITHUB_OUTPUT
        echo "ENV_FOLDER=pro >> $GITHUB_OUTPUT
      else
        echo "Invalid opntion!"
      fi
    shell: bash